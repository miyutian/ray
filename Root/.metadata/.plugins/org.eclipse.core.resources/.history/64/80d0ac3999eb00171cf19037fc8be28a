package com;
import java.io.BufferedReader;



import org.apache.http.Header;
import org.apache.http.HttpEntity;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClients;
import org.apache.http.util.EntityUtils;
import org.w3c.dom.Document;

import java.io.IOException; 
import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLConnection;
import java.util.ArrayList; 
import java.util.Date;
import java.util.List;
import java.util.Map;

public class GetCookie {
	public static void main(String[] args) throws ClientProtocolException, IOException{
		new GetCookie().Cookie();
	}
	public String Cookie(){
		String Cookie = "";
		String GCookie = "";
		try {


	  	  	String urlPath = new String("http://meridenp2c.com/cad/currentcalls.aspx");
	  	  	
	  	  	URL url=new URL(urlPath);
	  	  	HttpURLConnection httpConn=(HttpURLConnection)url.openConnection();
	  	          
	  	          //璁剧疆鍙傛暟
	  	          //httpConn.setDoOutput(true);     	//闇�杈撳嚭
	  	  	httpConn.setDoInput(true);      	//闇�杈撳叆
	  	  	httpConn.setUseCaches(false);   	//涓嶅厑璁哥紦瀛�
	  	  	httpConn.setRequestMethod("GET");   //璁剧疆GET鏂瑰紡杩炴帴
	  	          
	  	          //璁剧疆璇锋眰灞炴�
	  	  	httpConn.setRequestProperty("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8");
	  	  	httpConn.setRequestProperty("Accept-Encoding", "gzip, deflate");
	  	  	httpConn.setRequestProperty("Accept-Language", "en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,en-GB;q=0.6");
	  	  	httpConn.setRequestProperty("Connection", "Keep-Alive");// 缁存寔闀胯繛鎺�
	  	  	httpConn.setRequestProperty("Charset", "UTF-8");
	  	  	httpConn.setRequestProperty("Cache-Control", "no-cache");
	  	  	httpConn.setRequestProperty("User-Agent", "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36");
	  	          
	  	          //璁剧疆娴忚鍣ㄨ璇�
	  	          //String userCredentials = "testuser2:33abwe";
	  	          //String basicAuth = "Basic " + new String(new sun.misc.BASE64Encoder().encode(userCredentials.getBytes()));
	  	          //httpConn.setRequestProperty("Authorization", basicAuth);
	  	          
	  	          //杩炴帴,涔熷彲浠ヤ笉鐢ㄦ槑鏂嘽onnect锛屼娇鐢ㄤ笅闈㈢殑httpConn.getOutputStream()浼氳嚜鍔╟onnect
	  	  	httpConn.connect();
	  	  	Map<String, List<String>> map = httpConn.getHeaderFields();
	  	  	Cookie = map.get("Set-Cookie").toString();
	  	  	System.out.println("Cookie::"+Cookie);

	  	  	Cookie = Cookie.substring(1, Cookie.indexOf(";"));
	  	  	System.out.println("Cookie::"+Cookie);
	  	  	
	  	  	
	  	  	String googlePath = new String("http://meridenp2c.com/GoogleMap.aspx");
	  	  	
	  	  	URL googleurl=new URL(googlePath);
	  	  	HttpURLConnection googlehttpConn=(HttpURLConnection)url.openConnection();
	  	    System.out.println("22222222222222222222222222222222");      
	  	          //璁剧疆鍙傛暟
	  	          //httpConn.setDoOutput(true);     	//闇�杈撳嚭
		  	 googlehttpConn.setDoInput(true);      	//闇�杈撳叆
		  	 googlehttpConn.setUseCaches(false);   	//涓嶅厑璁哥紦瀛�
		  	 googlehttpConn.setRequestMethod("GET");   //璁剧疆GET鏂瑰紡杩炴帴
	  	          
	  	          //璁剧疆璇锋眰灞炴�
		  	 googlehttpConn.setRequestProperty("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8");
		  	 googlehttpConn.setRequestProperty("Accept-Encoding", "gzip, deflate");
  		  	 googlehttpConn.setRequestProperty("Accept-Language", "en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,en-GB;q=0.6");
 		  	 googlehttpConn.setRequestProperty("Connection", "Keep-Alive");// 缁存寔闀胯繛鎺�
		  	 googlehttpConn.setRequestProperty("Charset", "UTF-8");
		  	 googlehttpConn.setRequestProperty("Cache-Control", "no-cache");
		  	 googlehttpConn.setRequestProperty("User-Agent", "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36");
		  	          
		  	          //璁剧疆娴忚鍣ㄨ璇�
		  	          //String userCredentials = "testuser2:33abwe";
		  	          //String basicAuth = "Basic " + new String(new sun.misc.BASE64Encoder().encode(userCredentials.getBytes()));
		  	          //httpConn.setRequestProperty("Authorization", basicAuth);
		  	          
		  	          //杩炴帴,涔熷彲浠ヤ笉鐢ㄦ槑鏂嘽onnect锛屼娇鐢ㄤ笅闈㈢殑httpConn.getOutputStream()浼氳嚜鍔╟onnect
		  	 googlehttpConn.connect();
	  	  	 Map<String, List<String>> googlemap = httpConn.getHeaderFields();
	  	  	 GCookie = googlemap.get("Set-Cookie").toString();
	  	  	 System.out.println(GCookie);

	  	  	GCookie = GCookie.substring(1, GCookie.indexOf(";"));
	  	    System.out.println(GCookie);
	  	  	
	  	  	
		}
	  	  	catch (Exception e) {
			}
	  	  	return Cookie;
	}
}
